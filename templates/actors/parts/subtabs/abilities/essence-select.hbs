<!-- ============================================================
     ESSENCE SELECTION PANEL
     Three Primary Essences + Confluence Essence
     GM can edit; players see read-only
=============================================================== -->

<div class="essence-select-grid">

  <!-- ================================
       ESSENCE SLOT 1
  ================================= -->
  <div class="essence-slot">
    <h3>Essence 1</h3>

    <select name="system.essences.e1.key"
            {{#unless isGM}}disabled{{/unless}}>
      <option value="">— Select Essence —</option>
      {{> "systems/hwfwm-d20/templates/actors/parts/abilities/essence-options.hbs"
          current=system.essences.e1.key}}
    </select>
  </div>

  <!-- ================================
       ESSENCE SLOT 2
  ================================= -->
  <div class="essence-slot">
    <h3>Essence 2</h3>

    <select name="system.essences.e2.key"
            {{#unless isGM}}disabled{{/unless}}>
      <option value="">— Select Essence —</option>
      {{> "systems/hwfwm-d20/templates/actors/parts/abilities/essence-options.hbs"
          current=system.essences.e2.key}}
    </select>
  </div>

  <!-- ================================
       ESSENCE SLOT 3
  ================================= -->
  <div class="essence-slot">
    <h3>Essence 3</h3>

    <select name="system.essences.e3.key"
            {{#unless isGM}}disabled{{/unless}}>
      <option value="">— Select Essence —</option>
      {{> "systems/hwfwm-d20/templates/actors/parts/abilities/essence-options.hbs"
          current=system.essences.e3.key}}
    </select>
  </div>

  <!-- ================================
       CONFLUENCE ESSENCE
  ================================= -->
  <div class="essence-slot confluence-slot">
    <h3>Confluence Essence</h3>

    {{!-- 
      AUTO-POPULATED by combinations
      But GM can override if needed
    --}}
    <select name="system.essences.confluence.key"
            class="confluence-select"
            {{#unless isGM}}disabled{{/unless}}>
      <option value="">— Auto / GM Select —</option>

      {{!-- This partial filters available choices based on e1,e2,e3 --}}
      {{> "systems/hwfwm-d20/templates/actors/parts/abilities/confluence-options.hbs"
          e1=system.essences.e1.key
          e2=system.essences.e2.key
          e3=system.essences.e3.key
          current=system.essences.confluence.key}}
    </select>

    {{#unless isGM}}
      <p class="hint smalltext">Generated automatically</p>
    {{/unless}}
  </div>

</div>
